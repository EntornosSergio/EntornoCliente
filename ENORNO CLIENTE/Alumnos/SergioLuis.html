<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>CONTROL FORMULARIOS</title>
        <link rel="stylesheet" href="main.css">
    
    
    <style>
        span {
            display:none;
        }
        
        #precio {color: #222;
                font-weight: 600;
                line-height: 1.3;
                }
        
    </style>
    <script>

    

    function cargarFecha(){

        let fecha_hoy = new Date();
        let fecha_mañana = new Date();
        let dia=document.getElementById("fent");
        fecha_mañana.setDate(fecha_hoy.getDate() + 1);
        document.getElementById("fent").value=fecha_mañana.getDate() + "//" + (fecha_mañana.getMonth()+1) + "//" + (fecha_mañana.getFullYear()-2000);  
        var contador=0;
        t=["playa1.PNG","playa2.PNG","playa3.PNG","playa4.PNG"]
        
        a=window.setInterval(function(){
            document.getElementById("imagen").src=t[contador];
            contador++;

            if(contador==4)
            contador=0;
            },3000);
        }

    function colorear(evento,campo){
        if (evento.type === "mouseover") {
                campo.style.backgroundColor = "#81DAF5";
            } else if (evento.type === "mouseout") {
                campo.style.backgroundColor = "white";
            }
    }

    function calcular(){

        let entrada=document.getElementById("fent");
        let salida=document.getElementById("fsal");

        if (entrada.value==0){
            alert("La entrada no esta esta rellena");
            entrada.focus();
            return;
        }
        if (salida.value==0){
            alert("La salida no esta esta rellena");
            salida.focus();
            return;
        }

        const regexFecha=/^(0\d|[12]\d|3[01])\/\/(0\d|1[012])\/\/(24|25)$/
        if (!entrada.value.match(regexFecha)){
            alert("entrada mal escrito");
            return;
        } 

        if (!salida.value.match(regexFecha)){
            alert("salida mal escrito");
            return;
        } 

        let fecha_hoy = new Date();
        entrada.split("//");
        let fecha_entrada = new Date(entrada[2]+2000,entrada[1]-1,entrada[0]);
        let fecha_salida = new Date(salida[2]+2000,salida[1]-1,salida[0]);
        
        alert(fecha_entrada);
        alert(fecha_salida);

        if (fecha_entrada < fecha_hoy){
            alert("el dia de entrada ha de ser mayor que el dia de hoy")
            entrada.focus();
            return;
        }
        if (fecha_salida < fecha_entrada){
            alert("El dia de salida tiene que ser mayor al de entrada")
            salida.focus();
            return;
        }

        let codigo=document.getElementById("socio");

        let estudio=document.getElementById("check1");
        let habitacion1=document.getElementById("check2");
        let habitacion2=document.getElementById("check3");

        if (!estudio.checked && !habitacion1.checked && !habitacion2.checked){
            alert("Debe de haber alguno seleccionado");
            return;
        }
        if(codigo.value==0){
            alert("El campo codigo socio debe ser rellenado");
            codigo.focus();
            return;
        }
        const regexCodigo=/[13579ABC]{3,9}/;
        if (!socio.value.match(regexCodigo)){
            alert("socio mal escrito");
            socio.focus();
            return;
        } 

        const regexTel1=/^[67]\d{8}$/;
        const regexTel2=/\(^[67]\d{8}\)$/
        let telefono= document.getElementById("telefonos");
        if (!telefono.value.match(regexTel1) || telefono.value.match(regexTel2)){
            alert("telefono mal escrito");
            telefono.focus();
        } 
        let correo=document.getElementById("correo");
        if (telefono.value==0 && correo.value==0){
            var confirmar=window.confirm("Estas seguro de que no quiere que le contactemos??");
            if (confirmar){
                window.close()
            } else{
                window.alert("Debes de poner el correo y el telefono");
                return;
            }
        }

       
        document.getElementById("noches").value = fecha_salida.getDate()-fecha_entrada.getDate();
        

        total=0;
        if (estudio.checked){
            total=total + estudio.value;
        }
        if (habitacion1.checked){
            total=total + habitacion1.value;
        }
        if (habitacion2.checked){
            total=total + habitacion2.value;
        }

        const seguro = document.querySelector('input[name="seguro"]:checked').value;

        if (seguro==="si"){
            total=total + 30;
        }

        
    }

	function comprobarSocio(){
		// te puede venir bien para ver si la tecla pulsada corresponde a una de las 
		// posibles en el código de socio y aquí abrir la ventana de código erroneo
	
	}
    </script>
    </head>
    <body onload="cargarFecha()">

        <h1>APARTAMENTOS SOLYPLAYA</h1>
        <img src="pla4.PNG" id="imagen" width="300" height="200">
        <h2>Solicite información para su reserva</h2>
        
        Día Entrada&nbsp <input type="text" id="fent" size="8" onmouseover="colorear(event,this)" onmouseout="colorear(event,this)"> 
        <br>        
        Día Salida&nbsp&nbsp&nbsp  <input type="text" id="fsal" size="8" onmouseover="colorear(event,this)" onmouseout="colorear(event,this)"> 
        
        Noches:&nbsp&nbsp <input type="text" id="noches" size="2"readonly><br> <br> 
        <div>
        Actualmente nuestros precios por noche son (Iva incluido): <br>
           
        <input type="checkbox" id="check1" value="120" > Estudio (2 plazas) 120€   
        <br>
        <input type="checkbox" id="check2" value="200"> 1 habitación y salón (4 plazas) 200€     
        <br>
        <input type="checkbox" id="check3" value="250" > 2 habitaciones y salón (6 plazas) 250€     
        <br><br>
        Pudiendo aplicar uno de nuestros descuentos<br> 
			<select id="sel">
                <option >Ninguno</option>
                <option >Socio SOLYPLAYA Plata (5%)</option>
                <option >Socio SOLYPLAYA Oro (10%)</option>
                <option >Socio SOLYPLAYA Premium (20%)</option>
            </select>
            Código Socio <input type="text" id="socio" > 
        <br>
        Con seguro de cancelación <input type="radio" name="seguro" checked> Sí<input type="radio" name="seguro">No	
        <br><br>
        Si nos deja un teléfono (o dos) nosotros le llamamos
        <input type="text" id="telefonos" placeholder="999999999 (999999999)"> 
        <br>
        O su correo  
        <input type="text" id="correo" size="50"> 
       </div> 
        <br>
        <input type="button" value="CALCULAR PRECIO" onclick="calcular()"> <br><br>
         
        <div id="precio">Le mostraremos el precio</div>
        

    </body>
</html>
